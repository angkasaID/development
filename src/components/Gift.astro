---
// @ts-nocheck
// src/components/Gift.astro
import { UNDANGAN_CONFIG } from '../data/config'
import OrnamentBackground from './OrnamentBackground.astro'

// Ekstraksi data dari config.js
const bank1 = UNDANGAN_CONFIG.gifts[0]
const bank2 = UNDANGAN_CONFIG.gifts[1]
const qrisRecipientName = UNDANGAN_CONFIG.brideFullName
const address = `${UNDANGAN_CONFIG.physicalAddress}, ${UNDANGAN_CONFIG.physicalCity}`
const contact = UNDANGAN_CONFIG.contactNumber
const fullAddressAndContact = `${address} | Kontak: ${contact}`
const qrisImageUrl = UNDANGAN_CONFIG.qrisImageUrl
const qrisFileName = `QRIS-${UNDANGAN_CONFIG.groomName}-${UNDANGAN_CONFIG.brideName}.jpeg`
---

<!-- SECTION GIFT -->
<div
  id="gift"
  class="angkasa_slide relative flex snap-start items-center justify-center overflow-hidden"
  data-section="gift"
>
  <OrnamentBackground />

  <div
    class="angkasa_inner flex h-[calc(100dvh-80px)] w-full flex-col justify-center px-6 py-6 pt-10 sm:px-6 sm:py-8"
  >
    <div
      class="blur-card animated-content flex h-full w-full max-w-[540px] flex-col justify-center rounded-3xl bg-(--inv-bg)/30 p-6 shadow-lg backdrop-blur-sm sm:p-8"
    >
      <div
        class="content-layer font-dekor-1 mx-auto w-full max-w-[420px] px-4 py-6 text-center sm:px-6"
      >
        <h3
          data-animation-class="animate__fadeInDown"
          class="ornament-item animate__slow font-judul color-accent-2 border-rose-gold mb-6 inline-block border-b pb-2 text-3xl italic"
        >
          ✤ Kirim Hadiah ✤
        </h3>

        <p
          data-animation-class="animate__fadeInUp"
          class="font-dekor-1 ornament-item animate__slower mb-8 text-[15px] leading-relaxed"
        >
          Doa restu dari anda sudah merupakan karunia yang sangat berarti bagi
          kami. Namun, jika memberi adalah ungkapan tanda kasih anda, Anda dapat
          memberi kado melalui beberapa pilihan berikut ini:
        </p>

        <!-- TOMBOL-TOMBOL -->
        <div class="flex flex-col items-center gap-4 sm:gap-5">
          <button
            data-animation-class="animate__fadeInUp"
            onclick="openModal('modal-digital')"
            class="ornament-item color-accent-2 border-accent animate__delay-1s w-full max-w-[260px] rounded-full border px-10 py-3 text-sm font-bold uppercase shadow-inner duration-300"
          >
            <i class="fas fa-money-bill-transfer mr-2"></i> Transfer Bank
          </button>

          <button
            data-animation-class="animate__fadeInUp"
            onclick="openModal('modal-qris')"
            class="ornament-item color-accent-2 border-accent animate__delay-2s w-full max-w-[260px] rounded-full border px-10 py-3 text-sm font-bold uppercase shadow-inner duration-300 hover:bg-white/10"
          >
            <i class="fas fa-qrcode mr-2"></i> Pembayaran QRIS
          </button>

          <button
            data-animation-class="animate__fadeInUp"
            onclick="openModal('modal-fisik')"
            class="ornament-item color-accent-2 border-accent animate__delay-3s w-full max-w-[260px] rounded-full border px-10 py-3 text-sm font-bold uppercase shadow-inner duration-300"
          >
            <i class="fas fa-gift mr-2"></i> Kirim Kado Fisik
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  id="modal-digital"
  class="modal-backdrop fixed inset-0 z-[100] flex hidden items-center justify-center bg-white/30 p-4 opacity-0 backdrop-blur-md transition-opacity duration-300"
>
  <div
    class="modal-content w-full max-w-xs scale-95 transform rounded-2xl bg-white shadow-2xl transition-transform duration-300"
  >
    <div class="p-6 text-center">
      <h4 class="font-serif-elegant text-rose-gold mb-4 text-xl font-bold">
        Transfer Bank
      </h4>

      <div class="space-y-4 pt-4">
        <h5
          class="text-color-base border-rose-gold/50 border-b pb-2 text-lg font-bold"
        >
          Detail Rekening
        </h5>

        <div class="rounded-md border border-gray-200 bg-gray-100 p-3">
          <p id="bank-name-1" class="text-color-base text-sm font-bold">
            {bank1.bank}
          </p>
          <p id="bank-recipient-1" class="text-xs">A/N: {bank1.name}</p>
          <p id="bank-account-1" class="my-1 text-lg font-bold text-gray-800">
            {bank1.number}
          </p>
          <button
            id="copy-bank-1-btn"
            onclick={`copyAndClose('${bank1.number}', 'copy-bank-1-btn', 'modal-digital')`}
            class="text-btn btn-utama hover:bg-rose-gold/90 mt-2 rounded px-3 py-1 text-xs font-semibold transition duration-150"
          >
            <i class="fas fa-copy mr-1"></i> Salin & Tutup
          </button>
        </div>

        <div class="rounded-md border border-gray-200 bg-gray-100 p-3">
          <p id="bank-name-2" class="text-color-base text-sm font-bold">
            {bank2.bank}
          </p>
          <p id="bank-recipient-2" class="text-xs">A/N: {bank2.name}</p>
          <p id="bank-account-2" class="my-1 text-lg font-bold text-gray-800">
            {bank2.number}
          </p>
          <button
            id="copy-bank-2-btn"
            onclick={`copyAndClose('${bank2.number}', 'copy-bank-2-btn', 'modal-digital')`}
            class="text-btn btn-utama hover:bg-rose-gold/90 mt-2 rounded px-3 py-1 text-xs font-semibold transition duration-150"
          >
            <i class="fas fa-copy mr-1"></i> Salin & Tutup
          </button>
        </div>
      </div>

      <button onclick="closeModal('modal-digital')" class="hover: mt-6 text-sm">
        Tutup Daftar Rekening
      </button>
    </div>
  </div>
</div>

<div
  id="modal-qris"
  class="modal-backdrop fixed inset-0 z-[100] flex hidden items-center justify-center bg-white/30 p-4 opacity-0 backdrop-blur-md transition-opacity duration-300"
>
  <div
    class="modal-content w-full max-w-xs scale-95 transform rounded-2xl bg-white shadow-2xl transition-transform duration-300"
  >
    <div class="p-6 text-center">
      <h4 class="font-serif-elegant text-rose-gold mb-4 text-xl font-bold">
        Pembayaran QRIS
      </h4>

      <p class="mb-4 text-sm italic">
        Pindai kode di bawah dari aplikasi pembayaran Anda.
      </p>

      <div class="rounded-md border border-gray-200 bg-gray-100 p-4">
        <img
          src={qrisImageUrl}
          id="qris-image"
          onerror="this.src='https://placehold.co/200x200/2D3A50/C6915A?text=QRIS'"
          alt="QRIS Code"
          class="mx-auto h-53 w-53 rounded-md shadow-md"
        />
        <p class="mt-3 text-sm font-semibold">A/N: {qrisRecipientName}</p>
      </div>

      <a
        href={qrisImageUrl}
        download={qrisFileName}
        class="btn-utama text-btn mt-5 inline-block rounded-2xl px-4 py-2 text-sm font-bold uppercase shadow-md transition duration-300"
      >
        <i class="fas fa-download mr-2"></i> Download Gambar QRIS
      </a>

      <button
        onclick="closeModal('modal-qris')"
        class="hover: mx-auto mt-6 block text-sm"
      >
        Tutup QRIS
      </button>
    </div>
  </div>
</div>

<div
  id="modal-fisik"
  class="modal-backdrop fixed inset-0 z-[100] flex hidden items-center justify-center bg-white/30 p-4 opacity-0 backdrop-blur-md transition-opacity duration-300"
>
  <div
    class="modal-content w-full max-w-xs scale-95 transform rounded-2xl bg-white shadow-2xl transition-transform duration-300"
  >
    <div class="p-6 text-center">
      <div
        class="space-y-2 rounded-md border border-gray-200 bg-gray-100 p-3 text-left"
      >
        <p
          id="alamat-recipient-display"
          class="text-color-base text-sm font-bold"
        >
          Penerima: {qrisRecipientName}
        </p>
        <p id="alamat-detail-display" class="text-sm text-gray-800">
          {address}
        </p>
        <p id="alamat-contact-display" class="text-sm text-gray-800">
          Nomor Kontak: {contact}
        </p>
      </div>

      <button
        id="alamat-fisik-btn"
        onclick={`copyToClipboard('${fullAddressAndContact}', 'alamat-fisik-btn')`}
        class="text-btn btn-utama hover:bg-navy-modern/90 mt-5 rounded-2xl px-4 py-2 text-sm font-bold transition duration-150"
      >
        <i class="fas fa-copy mr-2"></i> Salin Alamat Pengiriman
      </button>
      <button
        onclick="closeModal('modal-fisik')"
        class="hover: mx-auto mt-6 block text-sm"
      >
        Tutup Kado
      </button>
    </div>
  </div>
</div>
