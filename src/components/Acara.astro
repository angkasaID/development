---
// src/components/Acara.astro
import { UNDANGAN_CONFIG } from '../data/config'
import OrnamentBackground from './OrnamentBackground.astro'

// Ambil data yang diperlukan
const { akadDayDisplay, akadDateDisplay, akadLocation, countdownTargetDate } =
  UNDANGAN_CONFIG
const akadMulai = UNDANGAN_CONFIG.akadTimeDisplay
const akadWaktuPenuh = `${akadMulai} - Selesai`
---

<div
  id="acara"
  class="angkasa_slide relative flex snap-start items-center justify-center overflow-hidden"
  data-section="acara"
>
  <!-- Ornament full-layer -->
  <OrnamentBackground />

  <div
    class="angkasa_inner flex h-[calc(100dvh-80px)] w-full flex-col justify-center px-6 py-6 pt-10 sm:px-6 sm:py-8"
  >
    <div
      class="blur-card animated-content flex h-full w-full max-w-[540px] flex-col justify-center rounded-3xl bg-(--inv-bg)/30 p-6 shadow-lg backdrop-blur-xs sm:p-8"
    >
      <div
        class="content-layer font-dekor-1 mx-auto w-full max-w-[460px] px-4 py-6 text-center sm:px-6 sm:py-8"
      >
        <div
          data-animation-class="animate__fadeInDown"
          class="ornament-item animate__slower mx-auto mb-6 w-[50px]"
        >
          <img
            src="/asset/images/wayang-kecil.png"
            alt="wayang kecil"
            class="h-auto w-full object-contain"
          />
        </div>

        <div
          data-animation-class="animate__fadeInDown"
          class="ornament-item animate__slower text-center"
        >
          <div class="font-judul color-accent text-base italic sm:text-lg">
            ✤ Akad Pernikahan ✤
          </div>
          <div id="akad-time" class="text-[15px]">{akadWaktuPenuh}</div>
        </div>

        <div
          data-animation-class="animate__zoomIn"
          class="ornament-item animate__slower mt-3 text-center"
        >
          <div
            id="akad-day"
            class="font-latin-jawa"
            style="font-size: 50px; line-height: 1.2"
          >
            {akadDayDisplay}
          </div>
          <div
            id="akad-date"
            class="color-accent font-accent"
            style="font-size: 50px; line-height: 1.2"
          >
            {akadDateDisplay}
          </div>
        </div>

        <div
          data-animation-class="animate__fadeInUp"
          class="ornament-item animate__slower mt-2 text-center"
        >
          <div class="font-judul color-accent text-base italic sm:text-lg">
            ✤ Kediaman Wanita ✤
          </div>
          <div
            id="akad-location"
            class="mx-auto max-w-xs text-center text-[15px]"
          >
            {akadLocation}
          </div>
        </div>

        <div
          data-animation-class="animate__fadeInUp"
          class="image- ornament-item animate__slower mx-auto mt-3"
          style="height: auto; width: 130px; overflow: hidden"
        >
          <img
            src="./asset/images/btm-kecil.png"
            style="width: 100%; height: 100%; object-fit: contain"
            alt="Ornamen Bawah"
          />
        </div>

        <div
          id="opening-countdown-display"
          data-animation-class="animate__fadeInUp"
          class="ornament-item animate__slower mt-6 mb-10 w-full"
          data-countdown-target={countdownTargetDate}
        >
          <div
            id="countdown-display-opening"
            class="font-dekor-1 mx-auto grid max-w-xs grid-cols-4 items-center justify-center gap-2 text-center"
          >
            <!-- Hari (Days) -->
            <div
              class="flex-1 rounded-lg bg-white/10 px-1 py-2 shadow-lg backdrop-blur-sm sm:px-3"
            >
              <div
                id="days-opening"
                class="color-accent text-xl leading-none font-bold sm:text-2xl"
              >
                00
              </div>
              <div class="color-accent mt-1 text-[13px] opacity-80 sm:text-xs">
                Hari
              </div>
            </div>

            <!-- Jam (Hours) -->
            <div
              class="flex-1 rounded-lg bg-white/10 px-1 py-2 shadow-lg backdrop-blur-sm sm:px-3"
            >
              <div
                id="hours-opening"
                class="color-accent text-xl leading-none font-bold sm:text-2xl"
              >
                00
              </div>
              <div class="color-accent mt-1 text-[13px] opacity-80 sm:text-xs">
                Jam
              </div>
            </div>

            <!-- Menit (Minutes) -->
            <div
              class="flex-1 rounded-lg bg-white/10 px-1 py-2 shadow-lg backdrop-blur-sm sm:px-3"
            >
              <div
                id="minutes-opening"
                class="color-accent text-xl leading-none font-bold sm:text-2xl"
              >
                00
              </div>
              <div class="color-accent mt-1 text-[13px] opacity-80 sm:text-xs">
                Menit
              </div>
            </div>

            <!-- Detik (Seconds) - MENGHAPUS 'hidden sm:block' AGAR TAMPIL DI MOBILE -->
            <div
              class="flex-1 rounded-lg bg-white/10 px-1 py-2 shadow-lg backdrop-blur-sm sm:px-3"
            >
              <div
                id="seconds-opening"
                class="color-accent text-xl leading-none font-bold sm:text-2xl"
              >
                00
              </div>
              <div class="color-accent mt-1 text-xs opacity-80">Detik</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- COUNTDOWN SCRIPT -->
<script is:inline>
  function initializeOpeningCountdown() {
    const box = document.getElementById('opening-countdown-display')
    if (!box) return

    const target = new Date(box.dataset.countdownTarget).getTime()

    const d = document.getElementById('days-opening')
    const h = document.getElementById('hours-opening')
    const m = document.getElementById('minutes-opening')
    const s = document.getElementById('seconds-opening')

    function tick() {
      const now = Date.now()
      const diff = target - now
      if (diff < 0) return

      d.textContent = String(Math.floor(diff / 86400000)).padStart(2, '0')
      h.textContent = String(Math.floor((diff / 3600000) % 24)).padStart(2, '0')
      m.textContent = String(Math.floor((diff / 60000) % 60)).padStart(2, '0')
      s.textContent = String(Math.floor((diff / 1000) % 60)).padStart(2, '0')
    }

    tick()
    setInterval(tick, 1000)
  }

  initializeOpeningCountdown()
</script>
